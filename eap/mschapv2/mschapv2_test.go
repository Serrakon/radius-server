package mschapv2

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestGenerateAuthenticatorResponse(t *testing.T) {
	ntResponse := []byte{
		0x82, 0x30, 0x9e, 0xcd, 0x8d, 0x70, 0x8b, 0x5e, 0xa0, 0x8f, 0xaa, 0x39, 0x81, 0xcd, 0x83,
		0x54, 0x42, 0x33, 0x11, 0x4a, 0x3d, 0x85, 0xd6, 0xdf,
	}
	peerChallenge := []byte{
		0x21, 0x40, 0x23, 0x24, 0x25, 0x5e, 0x26, 0x2a, 0x28, 0x29, 0x5f, 0x2b, 0x3a, 0x33, 0x7c,
		0x7e,
	}
	authChallenge := []byte{
		0x5b, 0x5d, 0x7c, 0x7d, 0x7b, 0x3f, 0x2f, 0x3e, 0x3c, 0x2c, 0x60, 0x21, 0x32, 0x26, 0x26,
		0x28,
	}

	authResponse := GenerateAuthenticatorResponse("clientPass", ntResponse, peerChallenge, authChallenge, []byte("User"))
	assert.Equal(t, "S=407A5589115FD0D6209F510FE9C04566932CDA56", authResponse)
}
